{"version":3,"sources":["webpack://library/webpack/universalModuleDefinition","webpack://library/webpack/bootstrap","webpack://library/./src/hooks/cache.js","webpack://library/./src/hooks/helpers/path.js","webpack://library/./src/hooks/redis.js","webpack://library/./src/index.js","webpack://library/./src/redisClient.js","webpack://library/./src/routes/cache.js","webpack://library/./src/routes/helpers/redis.js","webpack://library/external \"chalk\"","webpack://library/external \"debug\"","webpack://library/external \"express\"","webpack://library/external \"moment\"","webpack://library/external \"qs\"","webpack://library/external \"redis\""],"names":["defaults","defaultDuration","exports","cache","options","hook","cacheOptions","app","get","Object","assign","result","hasOwnProperty","Array","isArray","array","wrapped","cached","duration","Promise","resolve","removeCacheInformation","qs","parseNestedPath","path","params","re","RegExp","match","exec","keys","route","includes","replace","parsePath","config","removePathFromCacheKey","parseNestedRoutes","q","query","remove","id","length","stringify","encode","module","moment","chalk","makeDebug","debug","env","immediateCacheKey","extendDuration","before","client","callback","err","reply","data","JSON","parse","expiresOn","format","cyan","green","cacheKey","multi","expire","after","add","parent","key","set","humanize","cacheRoutes","redisClient","hookCache","hookRemoveCacheInformation","redisBeforeHook","redisAfterHook","redis","retryInterval","redisOptions","retry_strategy","undefined","yellow","createClient","on","express","RedisCache","HTTP_OK","HTTP_NO_CONTENT","HTTP_SERVER_ERROR","HTTP_NOT_FOUND","routes","router","Router","h","handler","target","url","reject","hasQueryString","decodeURIComponent","split","slice","join","message","clearSingle","then","r","status","req","res","flushall","json","send","lrange","clearGroup","end","constructor","del","clearAll","e","i"],"mappings":"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","file":"library.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"library\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"library\"] = factory();\n\telse\n\t\troot[\"library\"] = factory();\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/**\n * After hook - generates a cache object that is needed\n * for the redis hook and the express middelware.\n */\nconst defaults = {\n  defaultDuration: 3600 * 24\n};\n\nexports.cache = function (options) { // eslint-disable-line no-unused-vars\n  return function (hook) {\n    const cacheOptions = hook.app.get('redisCache');\n\n    options = Object.assign({}, defaults, cacheOptions, options);\n\n    if (!hook.result.hasOwnProperty('cache')) {\n      let cache = {};\n\n      if (Array.isArray(hook.result)) {\n        const array = hook.result;\n\n        cache.wrapped = array;\n        hook.result = {};\n      }\n\n      cache = Object.assign({}, cache, {\n        cached: false,\n        duration: options.duration || options.defaultDuration\n      });\n\n      hook.result.cache = cache;\n    }\n    return Promise.resolve(hook);\n  };\n};\n\nexports.removeCacheInformation = function removeCacheInformation(options) { // eslint-disable-line no-unused-vars\n  return function (hook) {\n    if (hook.result.hasOwnProperty('cache')) {\n      delete hook.result.cache;\n    }\n    return Promise.resolve(hook);\n  };\n};\n","const qs = require('qs');\n\nfunction parseNestedPath(path, params) {\n  const re = new RegExp(':([^\\\\/\\\\?]+)\\\\??', 'g');\n\n  let match = null;\n\n  while ((match = re.exec(path)) !== null) {\n    if (Object.keys(params.route).includes(match[1])) {\n      path = path.replace(match[0], params.route[match[1]]);\n    }\n  }\n\n  return path;\n}\n\nfunction parsePath(hook, config = {removePathFromCacheKey: false, parseNestedRoutes: false}) {\n  const q = hook.params.query || {};\n  const remove = config.removePathFromCacheKey;\n  const parseNestedRoutes = config.parseNestedRoutes;\n\n  let path = remove && hook.id ? '' : `${hook.path}`;\n\n  if (!remove && parseNestedRoutes) {\n    path = parseNestedPath(path, hook.params);\n  }\n\n  if (hook.id) {\n    if (path.length !== 0 && !remove) {\n      path += '/';\n    }\n    if (Object.keys(q).length > 0) {\n      path += `${hook.id}?${qs.stringify(q, { encode: false })}`;\n    } else {\n      path += `${hook.id}`;\n    }\n  } else {\n    if (Object.keys(q).length > 0) {\n      path += `?${qs.stringify(q, { encode: false })}`;\n    }\n  }\n\n  return path;\n}\n\nmodule.exports = { parsePath };\n","const moment = require('moment');\nconst chalk = require('chalk');\nconst { parsePath } = require('./helpers/path');\nconst makeDebug = require('debug');\n\nconst debug = makeDebug('feathers-hooks-rediscache:redis');\n\nconst defaults = {\n  env: 'production',\n  defaultDuration: 3600 * 24,\n  immediateCacheKey: false,\n  extendDuration: 0\n};\n\nexports.before = function before(options) { // eslint-disable-line no-unused-vars\n  return function (hook) {\n    const cacheOptions = hook.app.get('redisCache');\n\n    options = Object.assign({}, defaults, cacheOptions, options);\n\n    return new Promise(resolve => {\n      const extendDuration = options.extendDuration || options.extendDuration;\n      const client = hook.app.get('redisClient');\n\n      if (!client) {\n        resolve(hook);\n      }\n\n      const path = parsePath(hook, options);\n\n      const callback = (err, reply) => {\n        if (err !== null) resolve(hook);\n        if (reply) {\n          let data = JSON.parse(reply);\n          const duration = moment(data.cache.expiresOn).format('DD MMMM YYYY - HH:mm:ss');\n\n          hook.result = data;\n          resolve(hook);\n\n          /* istanbul ignore next */\n          if (options.env !== 'test') {\n            debug(`${chalk.cyan('[redis]')} returning cached value for ${chalk.green(path)}.`);\n            debug(`> Expires on ${duration}.`);\n          }\n        } else {\n          if (options.immediateCacheKey === true) {\n            hook.params.cacheKey = path;\n          }\n          resolve(hook);\n        }\n      };\n\n      if (extendDuration) {\n        client.multi()\n          .get(path, callback)\n          .expire(path, extendDuration)\n          .exec();\n      } else {\n        client.get(path, callback);\n      }\n    });\n  };\n};\n\nexports.after = function after(options) { // eslint-disable-line no-unused-vars\n  return function (hook) {\n    const cacheOptions = hook.app.get('redisCache');\n\n    options = Object.assign({}, defaults, cacheOptions, options);\n\n    return new Promise(resolve => {\n      if (!hook.result.cache.cached) {\n        const duration = hook.result.cache.duration || options.defaultDuration;\n        const client = hook.app.get('redisClient');\n\n        if (!client) {\n          resolve(hook);\n        }\n\n        const path = hook.params.cacheKey || parsePath(hook, options);\n\n        // adding a cache object\n        Object.assign(hook.result.cache, {\n          cached: true,\n          duration: duration,\n          expiresOn: moment().add(moment.duration(duration, 'seconds')),\n          parent: hook.path,\n          key: path\n        });\n\n        client.set(path, JSON.stringify(hook.result));\n        client.expire(path, hook.result.cache.duration);\n\n        /* istanbul ignore next */\n        if (options.env !== 'test') {\n          debug(`${chalk.cyan('[redis]')} added ${chalk.green(path)} to the cache.`);\n          debug(`> Expires in ${moment.duration(duration, 'seconds').humanize()}.`);\n        }\n      }\n\n      if (hook.result.cache.hasOwnProperty('wrapped')) {\n        const { wrapped } = hook.result.cache;\n\n        hook.result = wrapped;\n      }\n\n      resolve(hook);\n    });\n  };\n};\n\n","const cacheRoutes = require('./routes/cache.js');\nconst redisClient = require('./redisClient.js');\nconst { cache: hookCache } = require('./hooks/cache.js');\nconst { removeCacheInformation: hookRemoveCacheInformation } = require('./hooks/cache.js');\nconst { before: redisBeforeHook} = require('./hooks/redis.js');\nconst { after: redisAfterHook} = require('./hooks/redis.js');\n\nmodule.exports = {\n  redisClient,\n  cacheRoutes,\n  hookCache,\n  hookRemoveCacheInformation,\n  redisBeforeHook,\n  redisAfterHook\n};\n","const redis = require('redis');\nconst chalk = require('chalk');\nconst makeDebug = require('debug');\n\nconst debug = makeDebug('feathers-hooks-rediscache:redisClient');\n\nmodule.exports = function () { // eslint-disable-line no-unused-vars\n  const app = this;\n  const cacheOptions = app.get('redisCache') || {};\n  const retryInterval = cacheOptions.retryInterval || 10000;\n  const redisOptions = Object.assign({}, this.get('redis'), {\n    retry_strategy: function (options) { // eslint-disable-line camelcase\n      app.set('redisClient', undefined);\n      /* istanbul ignore next */\n      if (cacheOptions.env !== 'test') {\n        debug(`${chalk.yellow('[redis]')} not connected`);\n      }\n      return retryInterval;\n    }\n  });\n  const client = redis.createClient(redisOptions);\n\n  app.set('redisClient', client);\n\n  client.on('ready', () => {\n    app.set('redisClient', client);\n    /* istanbul ignore next */\n    if (cacheOptions.env !== 'test') {\n      debug(`${chalk.green('[redis]')} connected`);\n    }\n  });\n  return this;\n};\n","const express = require('express');\n\nconst RedisCache = require('./helpers/redis');\n\nconst HTTP_OK = 200;\nconst HTTP_NO_CONTENT = 204;\nconst HTTP_SERVER_ERROR = 500;\nconst HTTP_NOT_FOUND = 404;\n\nfunction routes(app) {\n  const router = express.Router();\n  const client = app.get('redisClient');\n  const h = new RedisCache(client);\n\n  function handler(target, query, url) {\n\n    return new Promise((resolve, reject) => {\n      // Formatted options following ?\n      const hasQueryString = (query && (Object.keys(query).length !== 0));\n\n      // Target should always be defined as Express router raises 404\n      // as route is not handled\n      if (target.length) {\n        if (hasQueryString) {\n          // Keep queries in a single string with the taget\n          target = decodeURIComponent(url.split('/').slice(3).join('/'));\n        }\n\n        // Gets the value of a key in the redis client\n        client.get(`${target}`, (err, reply) => {\n          if (err) {\n            return reject('something went wrong' + err.message);\n          }\n          // If the key existed\n          if (reply) {\n            // Clear existing cached key\n            h.clearSingle(target).then(r => {\n              return resolve({\n                message: `cache cleared for key (${hasQueryString ?\n                  'with' : 'without'} params): ${target}`,\n                status: HTTP_OK\n              });\n            });\n          } else {\n            /**\n             * Empty reply means the key does not exist.\n             * Must use HTTP_OK with express as HTTP's RFC stats 204 should not\n             * provide a body, message would then be lost.\n             */\n            return resolve({\n              message: `cache already cleared for key (${hasQueryString ?\n                'with' : 'without'} params): ${target}`,\n              status: HTTP_NO_CONTENT\n            });\n          }\n\n          return null;\n        });\n      } else {\n        return reject(HTTP_NOT_FOUND);\n      }\n\n      return {};\n    });\n  }\n\n  router.get('/clear', (req, res) => {\n    client.flushall('ASYNC', () => {\n      res.status(HTTP_OK).json({\n        message: 'Cache cleared',\n        status: HTTP_OK\n      });\n    });\n  }); // clear a unique route\n\n  // clear a unique route\n  router.get('/clear/single/*', async (req, res) => {\n    let result;\n\n    try {\n      result = await handler(decodeURIComponent(req.params[0]), req.query, req.url);\n    } catch (err) {\n      result = err;\n    }\n    res.status(result.status).send(result);\n  });\n\n  // clear a group\n  router.get('/clear/group/*', (req, res) => {\n    let target = decodeURIComponent(req.params[0]);\n\n    // Target should always be defined as Express router raises 404\n    // as route is not handled\n    if (target.length) {\n      target = 'group-' + target;\n      // Returns elements of the list associated to the target/key 0 being the\n      // first and -1 specifying get all till the latest\n      client.lrange(target, 0, -1, (err, reply) => {\n        if (err) {\n          res.status(HTTP_SERVER_ERROR).json({\n            message: 'something went wrong' + err.message\n          });\n        } else {\n          // If the list/group existed and contains something\n          if (reply && Array.isArray(reply) && (reply.length > 0)) {\n            // Clear existing cached group key\n            h.clearGroup(target).then(r => {\n              res.status(HTTP_OK).json({\n                message:\n                  `cache cleared for the group key: ${decodeURIComponent(req.params[0])}`,\n                status: HTTP_OK\n              });\n            });\n          } else {\n            /**\n             * Empty reply means the key does not exist.\n             * Must use HTTP_OK with express as HTTP's RFC stats 204 should not\n             * provide a body, message would then be lost.\n             */\n            res.status(HTTP_OK).json({\n              message:\n                `cache already cleared for the group key: ${decodeURIComponent(req.params[0])}`,\n              status: HTTP_NO_CONTENT\n            });\n          }\n        }\n      });\n    } else {\n      res.status(HTTP_NOT_FOUND).end();\n    }\n  });\n\n  // add route to display cache index\n  // this has been removed for performance issues\n  // router.get('/index', (req, res) => {\n  //   let results = new Set();\n\n  //   h.scanAsync('0', '*', results)\n  //     .then(data => {\n  //       res.status(200).json(data);\n  //     })\n  //     .catch(err => {\n  //       res.status(404).json(err);\n  //     });\n\n  // });\n\n  return router;\n}\n\nmodule.exports = routes;\n","class RedisCache {\n  constructor(client) {\n    this.client = client;\n  }\n\n  /**\n   * scan the redis index\n   */\n  // scan() {\n  //   // starts at 0 if cursor is again 0 it means the iteration is finished\n  //   let cursor = '0';\n\n  //   return new Promise((resolve, reject) => {\n  //     this.client.scan(cursor, 'MATCH', '*', 'COUNT', '100', (err, reply) => {\n  //       if (err) {\n  //         reject(err);\n  //       }\n\n  //       cursor = reply[0];\n  //       if (cursor === '0') {\n  //         resolve(reply[1]);\n  //       } else {\n  //         // do your processing\n  //         // reply[1] is an array of matched keys.\n  //         // console.log(reply[1]);\n  //         return this.scan();\n  //       }\n  //       return false;\n  //     });\n\n  //   });\n  // }\n\n  /**\n   * Async scan of the redis index\n   * Do not for get to passin a Set\n   * myResults = new Set();\n   *\n   * scanAsync('0', \"NOC-*[^listen]*\", myResults).map(\n   *   myResults => { console.log( myResults); }\n   * );\n   *\n   * @param {String} cursor - string '0'\n   * @param {String} patern - string '0'\n   * @param {Set} returnSet - pass a set to have unique keys\n   */\n  // scanAsync(cursor, pattern, returnSet) {\n  //   // starts at 0 if cursor is again 0 it means the iteration is finished\n\n  //   return new Promise((resolve, reject) => {\n  //     this.client.scan(cursor, 'MATCH', pattern, 'COUNT', '100', (err, reply) => {\n\n  //       if (err) {\n  //         reject(err);\n  //       }\n\n  //       cursor = reply[0];\n  //       const keys = reply[1];\n\n  //       keys.forEach((key, i) => {\n  //         returnSet.add(key);\n  //       });\n\n  //       if (cursor === '0') {\n  //         resolve(Array.from(returnSet));\n  //       }\n\n  //       return this.scanAsync(cursor, pattern, returnSet);\n  //     });\n  //   });\n  // }\n\n  /**\n   * Clean single item from the cache\n   * @param {string} key - the key to find in redis\n   */\n  clearSingle(key) {\n    return new Promise((resolve, reject) => {\n      this.client.del(`${key}`, (err, reply) => {\n        if (err) reject(false);\n        if (reply === 1) {\n          resolve(true);\n        }\n        resolve(false);\n      });\n    });\n  }\n\n  /**\n   * Clear a group\n   * @param {string} key - key of the group to clean\n   */\n  clearGroup(key) {\n    return new Promise((resolve, reject) => {\n      this.client.lrange(key, 0, -1, (err, reply) => {\n        if (err) {\n          reject(err);\n        }\n        this.clearAll(reply).then(\n          this.client.del(key, (e, r) => {\n            resolve(r === 1);\n          })\n        );\n      });\n    });\n  }\n\n  /**\n   * Clear all keys of a redis list\n   * @param {Object[]} array\n   */\n  clearAll(array) {\n    return new Promise(resolve => {\n      if (!array.length) resolve(false);\n      let i = 0;\n\n      for (i; i < array.length; i++) {\n        this.clearSingle(array[i]).then(r => {\n          if (i === array.length - 1) {\n            resolve(r);\n          }\n        });\n      }\n    });\n  }\n};\n\nmodule.exports = RedisCache;\n","module.exports = require(\"chalk\");","module.exports = require(\"debug\");","module.exports = require(\"express\");","module.exports = require(\"moment\");","module.exports = require(\"qs\");","module.exports = require(\"redis\");"],"sourceRoot":""}